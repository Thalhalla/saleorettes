#!/bin/sh
echo "Wait on at least three nodes of the mongo cluster settle"

mongow8 () {
  echo -n "waiting on mongo-$1"

  for i in {1..150}; do # timeout for 15 minutes
    echo -n '.'
    RESULT=$(kubectl get po | grep mongo-$1 | grep Running)
    if [ "$RESULT" ]; then
        echo "$RESULT"
        break
    fi
    sleep 6
  done

  echo -e "\nmongo-$1 is now up and running."
}

for i in {0..2}; do
  mongow8 $i
done
